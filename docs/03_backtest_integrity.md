03. Backtest Integrity & Trading Cost Assumptions
1. 목적 (Purpose)

본 장의 목적은 자동매매 전략의 성과 자체가 아닌,
백테스트 결과가 현실적인 거래 환경을 얼마나 정확히 반영하는지를 검증하는 데 있다.
이를 위해 다음 세 가지 요소를 중심으로 백테스트 엄밀성을 확보하였다.

체결 가정(Fill Assumption)에 따른 룩어헤드 편향 방지

거래비용(수수료·매도세·슬리피지)의 현실적 반영

단일 종목이 아닌 코스닥 유니버스 기반 검증

2. 체결 가정(Fill Mode)과 룩어헤드 방지
2.1 체결 가정 정의

본 프로젝트에서는 체결 가정을 다음 두 가지로 구분하여 비교하였다.

close

신호 발생 당일 종가에 체결되었다고 가정

성과 비교용(reference)으로만 사용

룩어헤드 편향 가능성 존재

next_open (기본값)

신호 발생 다음 거래일 시가에 체결

실제 자동매매 환경에 가장 근접한 가정

룩어헤드 편향 방지를 위한 운영 기본값

모든 실전/모의 운용 가정은 next_open 체결을 기본으로 한다.

2.2 체결 가정 비교 실험

동일 전략, 동일 기간, 동일 유니버스에 대해
next_open과 close 체결 가정을 비교하였다.

비교 결과, 평균 및 중앙값 기준 성과 차이는 제한적이었다.

이는 본 전략이 저회전 구조이며,
신호 발생일과 익일 시가 간 가격 괴리가 크지 않은 구간이 많았기 때문이다.

그러나 이는 룩어헤드 문제가 없다는 의미는 아니며,
구조적 안정성을 위해 운영 기본 가정은 next_open으로 유지한다.

3. 거래비용 반영 기준 (Trading Cost Assumptions)
3.1 수수료 및 세금

본 프로젝트는 한국투자증권 국내주식 온라인 거래 기준을 적용하였다.

항목	적용 값	비고
매수/매도 수수료	0.147% (14.7 bp)	온라인 거래 기준
매도세(증권거래세)	0.15% (15 bp)	매도 시에만 적용

해당 값은 setting.yaml에 기본값으로 반영되어 있으며,
백테스트 단계에서 일관되게 사용된다.

3.2 슬리피지(Slippage)

코스닥 시장의 특성상 다음과 같은 이유로 슬리피지는 현실적으로 발생한다.

상대적으로 얕은 호가 잔량

시장가 주문 시 다중 호가 체결

시초가(next_open) 체결 시 가격 갭 발생 가능성

이에 따라 본 프로젝트에서는 다음과 같이 슬리피지를 가정하였다.

시장	슬리피지 가정
코스닥 중형주	10 bp (0.10%)

매수 시 체결가 불리(+)

매도 시 체결가 불리(−) 방향으로 반영

4. 유니버스 기반 비교 실험
4.1 실험 설정

시장: 코스닥

유니버스: 거래대금·변동성 기준 상위 30종목

비교 시나리오:

케이스	체결 가정	비용 반영
A	next_open	OFF
B	next_open	ON
C	close	ON
4.2 결과 요약 (Top 30 평균/중앙값)

거래비용을 반영한 경우에도 성과 분포는 급격히 악화되지 않음

이는 전략이 과도한 매매에 의존하지 않는 저회전 구조임을 시사

체결 가정(close vs next_open)에 따른 평균 성과 차이는 제한적

단일 종목이 아닌 유니버스 평균 및 중앙값 기준으로 비교함으로써
특정 종목의 극단값(outlier)에 의존하지 않는 분석을 수행하였다.

5. 결과 해석 및 한계

본 전략은 추세 레짐에 민감한 구조로,
전체 기간 평균 샤프지수는 낮게 나타났다.

이는 전략의 구조적 오류라기보다,
레짐 분할 분석을 통해 개선 가능한 영역으로 판단된다.

본 장의 핵심 목적은 성과 극대화가 아닌 백테스트의 신뢰성 확보이며,
해당 목적은 충분히 달성되었다고 판단한다.

6. 결론

본 프로젝트는 다음을 충족한다.

룩어헤드 편향을 방지한 체결 구조 설계

실거래 환경을 반영한 거래비용·세금·슬리피지 반영

단일 종목이 아닌 코스닥 유니버스 기반 검증

평균·중앙값·표본 수를 함께 제시한 재현 가능한 분석

이를 통해 본 자동매매 시스템의 백테스트 결과는
현실적이고 신뢰 가능한 성과 지표로 해석될 수 있다.